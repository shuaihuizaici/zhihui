import{c as $,n as F,$ as X,m as j,t as q,aZ as J,d as K,ar as O,r as W,i as p,Q as ee,at as ae,a as f,I as G,aQ as Q,a0 as te,y as oe,w as le}from"./index-Bo7BXbGR.js";import{u as se}from"./use-refs-BOWF5-Oy.js";const[ne,h]=$("rate");function ie(a,n,s,r){return a>=n?{status:"full",value:1}:a+.5>=n&&s&&!r?{status:"half",value:.5}:a+1>=n&&s&&r?{status:"half",value:Math.round((a-n+1)*1e10)/1e10}:{status:"void",value:0}}const re={size:F,icon:X("star"),color:String,count:j(5),gutter:F,clearable:Boolean,readonly:Boolean,disabled:Boolean,voidIcon:X("star-o"),allowHalf:Boolean,voidColor:String,touchable:q,iconPrefix:String,modelValue:J(0),disabledColor:String};var ue=K({name:ne,props:re,emits:["change","update:modelValue"],setup(a,{emit:n}){const s=O(),[r,S]=se(),m=W(),T=p(()=>a.readonly||a.disabled),I=p(()=>T.value||!a.touchable),Y=p(()=>Array(+a.count).fill("").map((t,e)=>ie(a.modelValue,e+1,a.allowHalf,a.readonly)));let l,u,g=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER;const V=()=>{u=Q(m);const t=r.value.map(Q);l=[],t.forEach((e,o)=>{g=Math.min(e.top,g),v=Math.max(e.top,v),a.allowHalf?l.push({score:o+.5,left:e.left,top:e.top,height:e.height},{score:o+1,left:e.left+e.width/2,top:e.top,height:e.height}):l.push({score:o+1,left:e.left,top:e.top,height:e.height})})},y=(t,e)=>{for(let o=l.length-1;o>0;o--)if(e>=u.top&&e<=u.bottom){if(t>l[o].left&&e>=l[o].top&&e<=l[o].top+l[o].height)return l[o].score}else{const c=e<u.top?g:v;if(t>l[o].left&&l[o].top===c)return l[o].score}return a.allowHalf?.5:1},N=t=>{T.value||t===a.modelValue||(n("update:modelValue",t),n("change",t))},x=t=>{I.value||(s.start(t),V())},D=t=>{if(!I.value&&(s.move(t),s.isHorizontal()&&!s.isTap.value)){const{clientX:e,clientY:o}=t.touches[0];te(t),N(y(e,o))}},L=(t,e)=>{const{icon:o,size:c,color:w,count:C,gutter:E,voidIcon:k,disabled:i,voidColor:z,allowHalf:H,iconPrefix:M,disabledColor:_}=a,b=e+1,R=t.status==="full",d=t.status==="void",U=H&&t.value>0&&t.value<1;let B;E&&b!==+C&&(B={paddingRight:oe(E)});const Z=A=>{V();let P=H?y(A.clientX,A.clientY):b;a.clearable&&s.isTap.value&&P===a.modelValue&&(P=0),N(P)};return f("div",{key:e,ref:S(e),role:"radio",style:B,class:h("item"),tabindex:i?void 0:0,"aria-setsize":C,"aria-posinset":b,"aria-checked":!d,onClick:Z},[f(G,{size:c,name:R?o:k,class:h("icon",{disabled:i,full:R}),color:i?_:R?w:z,classPrefix:M},null),U&&f(G,{size:c,style:{width:t.value+"em"},name:d?k:o,class:h("icon",["half",{disabled:i,full:!d}]),color:i?_:d?z:w,classPrefix:M},null)])};return ee(()=>a.modelValue),ae("touchmove",D,{target:m}),()=>f("div",{ref:m,role:"radiogroup",class:h({readonly:a.readonly,disabled:a.disabled}),tabindex:a.disabled?void 0:0,"aria-disabled":a.disabled,"aria-readonly":a.readonly,onTouchstartPassive:x},[Y.value.map(L)])}});const fe=le(ue);export{fe as R};
